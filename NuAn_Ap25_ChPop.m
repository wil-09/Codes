function NuAn_Ap25_ChPop
% Numerical integration of the two populations chemotaxis model with
% cortical flows: application of the Euler method. 11th April 2025
tic
clear all; close all; clc
set(0, 'defaultaxesfontsize', 20, 'defaultaxesfontWeight', 'bold', 'defaultaxesLineWidth', 1)
i = sqrt(-1); 

% Gridspace
xlim = 10; x0 = -xlim; xf = xlim; dx = 0.05; t0 = 0; tf = 1; 
dt = 1e-4 ; % dx*(tf - t0)/(xf - x0),
x = x0:dx:xf; t = t0:dt:tf; N = numel(x); M = numel(t);

%%%%%%% parameters fo Fig 3.
% D1 = 1.76; D2 = 3.29; D3 = 8; chi1 = 0.0649; chi2 = 0.288; u0 = 0.9; 
% r1 = 0.1; r2 = 0.9; alpha1 = 2; alpha2 = 5; mu = 0.035; beta = 100;
% h1 = 1; h2 = 5; beta1 = 8; beta2 = 10; k = 0.05; eps = 0.01; 
%%%%%%%%%%%%%%%%%%%

% Parameters of the model
% D1 = 1.76; D2 = 3.29; D3 = 8; chi1 = 0.0649; chi2 = 0.288; u0 = 0.9;
% r1 = 0.1; r2 = 0.1; alpha1 = 0.2; alpha2 = 0.5; mu = 0.035; beta = 100;
% h1 = 0.01; h2 = 0.05; beta1 = 8; beta2 = 10; k = 0.09; eps = 0.01; 

D1 = 1.76; D2 = 3.29; D3 = 8; chi1 = 0.0649; chi2 = 0.288; u0 = 0.9; 
r1 = 0.1; r2 = 0.9; alpha1 = 0.25; alpha2 = 0.9; mu = 0.035; beta = 0;
h1 = 1; h2 = 1; beta1 = 0.0035; beta2 = 0.0035; k = pi; eps = 0.01; 

% for beta = 0
    sigma1 = chi1*(1 + beta); sigma2 = chi2*(1 - beta);
    n11 = r1 - 2.*D1./dx.^2; n22 = D1./dx.^2 - 0.5.*u0./dx; n66 = - sigma2./dx.^2;
    n33 = D1./dx.^2 + 0.5.*u0./dx; n44 = -chi1./dx.^2; n55 = - sigma1./dx.^2;
    m111 = r2 - 2.*D2./dx.^2; m221 = D2./dx.^2 - 0.5.*u0./dx; 
    m331 = D2./dx.^2 + 0.5.*u0./dx; m441 = -chi2./dx.^2;
    c11 = - mu - 2.*D3./dx.^2; c22 = D3./dx.^2 - 0.5.*u0./dx;
    c33 = D3./dx.^2 + 0.5.*u0./dx;
    
%     Parameters of the steady state
    n0 = (alpha1 - 1)./(alpha1.*alpha2 - 1); m0 = (alpha2 - 1)./(alpha1.*alpha2 - 1);
    c0 = (h1.*(alpha1 - 1) + h2.*(alpha2 - 1))./(mu.*(alpha1.*alpha2 - 1) + beta1.*(alpha1 - 1) + beta2.*(alpha2 - 1));
    Fn = r1.*(1 - 2.*n0 - alpha1.*m0); Fm = -r1.*alpha1.*n0; Hn = h1 - beta1.*c0;
    Gn = -r2.*alpha2.*m0; Gm = r2.*(1 - 2.*m0 - alpha2.*n0); Hm = h2 - beta2.*c0; Hc = -(mu + beta1.*n0 + beta2.*m0);

    % % note that Delta = nabla^2 p + (nabla p)^2 and p = i.*k.*r + ln(L(r))
    x00 = 0; a = 1; x00n = -3; x00m = 3; 
    Delta = @(x) -(sech((x - x00)./a)./a).^2 + (i.*k - tanh((x - x00)./a)./a).^2;
    lambda1 = @(x) -u0.*(k.*i - tanh((x - x00)./a)./a) + (((36.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) - 108.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)) - 8.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 + 12.*sqrt(12.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 - 3.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^2.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^2 - 54.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) + 12.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^3 + 81.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).^2)).^(1./3)) - 4.*(3.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))) - (- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^2)./((36.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) - 108.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)) - 8.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 + 12.*sqrt(12.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 - 3.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^2.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^2 - 54.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) + 12.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^3 + 81.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).^2)).^(1./3)) - 2.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))))./6;
    lambda2 = @(x) -u0.*(k.*i - tanh((x - x00)./a)./a) - ((36.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) - 108.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)) - 8.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 + 12.*sqrt(12.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 - 3.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^2.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^2 - 54.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) + 12.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^3 + 81.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).^2)).^(1./3))./12 + (3.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))) - (- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^2)./(3.*((36.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) - 108.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)) - 8.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 + 12.*sqrt(12.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 - 3.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^2.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^2 - 54.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) + 12.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^3 + 81.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).^2)).^(1./3))) - (- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0))))./3 + i.*(sqrt(3).*(((36.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) - 108.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)) - 8.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 + 12.*sqrt(12.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 - 3.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^2.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^2 - 54.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) + 12.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^3 + 81.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).^2)).^(1./3))./12 + (3.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))) - (- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^2)./(3.*((36.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) - 108.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)) - 8.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 + 12.*sqrt(12.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 - 3.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^2.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^2 - 54.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) + 12.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^3 + 81.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).^2)).^(1./3)))));
    lambda3 = @(x) -u0.*(k.*i - tanh((x - x00)./a)./a) - ((36.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) - 108.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)) - 8.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 + 12.*sqrt(12.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 - 3.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^2.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^2 - 54.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) + 12.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^3 + 81.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).^2)).^(1./3))./12 + (3.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))) - (- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^2)./(3.*((36.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) - 108.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)) - 8.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 + 12.*sqrt(12.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 - 3.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^2.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^2 - 54.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) + 12.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^3 + 81.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).^2)).^(1./3))) - (- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0))))./3 + i.*(- sqrt(3).*(((36.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) - 108.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)) - 8.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 + 12.*sqrt(12.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 - 3.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^2.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^2 - 54.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) + 12.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^3 + 81.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).^2)).^(1./3))./12 + (3.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))) - (- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^2)./(3.*((36.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) - 108.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)) - 8.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 + 12.*sqrt(12.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^3 - 3.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^2.*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))).^2 - 54.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).*(- ((D3.*Delta(x) + Hc) + (Gm + Delta(x).*(D2 - sigma2.*m0)) + (Fn + Delta(x).*(D1 - sigma1.*n0)))) + 12.*(-(-(Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)) - (Fn + Delta(x).*(D1 - sigma1.*n0)).*(D3.*Delta(x) + Hc) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn) + (chi1.*n0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm))).^3 + 81.*(- (Fn + Delta(x).*(D1 - sigma1.*n0)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(D3.*Delta(x) + Hc) + (Fn + Delta(x).*(D1 - sigma1.*n0)).*(chi2.*m0.*Delta(x)).*(sigma2.*c0.*Delta(x) - Hm) + (sigma2.*n0.*Delta(x) - Fm).*(sigma1.*m0.*Delta(x) - Gn).*(D3.*Delta(x) + Hc) - (sigma2.*n0.*Delta(x) - Fm).*(chi2.*m0.*Delta(x)).*(sigma1.*c0.*Delta(x) - Hn) - (chi1.*n0.*Delta(x)).*(sigma1.*m0.*Delta(x) - Gn).*(sigma2.*c0.*Delta(x) - Hm) + (chi1.*n0.*Delta(x)).*(Gm + Delta(x).*(D2 - sigma2.*m0)).*(sigma1.*c0.*Delta(x) - Hn)).^2)).^(1./3)))));
    Vfr1 = @(x) (imag(lambda1(x))./k); Vfr2 = @(x) (imag(lambda2(x))./k); Vfr3 = @(x) (imag(lambda3(x))./k); 
    Ven1 = @(x) -a.*(real(lambda1(x)))./tanh((x - x00)./a); Ven2 = @(x) -a.*(real(lambda2(x)))./tanh((x - x00)./a); Ven3 = @(x) -a.*(real(lambda3(x)))./tanh((x - x00)./a);
%     Vfr = @(x) max(imag(lambda(x))./k); Ven = @(x) -a.*max(real(lambda(x)))./tanh((x - x00)./a);
    lambda = @(x) [lambda1(x) lambda2(x) lambda3(x)]; 
    V_fr = @(x) [Vfr1(x) Vfr2(x) Vfr3(x)]; V_en = @(x) [Ven1(x) Ven2(x) Ven3(x)];
    GR = @(x) max(real(lambda(x))); Vfr = @(x) max(V_fr(x)); Ven = @(x) max(V_en(x));
    % We define the perturbed steady state as
    nn = zeros(1,N); mm = zeros(1,N); cc = zeros(1,N); Er0 = zeros(1,N);
for l = 1:M
    for j = 1:N
        nn(l,j) = n0 + eps.*sech((x(j) - x00n)./a).*cos(k*(x(j)));
        mm(l,j) = m0 + eps.*sech((x(j) - x00m)./a).*cos(k*(x(j)));
        cc(l,j) = c0 + eps.*sech((x(j) - x00)./a).*cos(k*(x(j)));
        Er0(l,j) = 0*nn(l,j);
    end
end

% First row of of the above defined matries as initial conditions
n(1:N) = nn(1,1:N); c(1:N) = cc(1,1:N); m(1:N) = mm(1,1:N);
Nf1 = []; Cf1 = []; Mf1 = []; Er1 = [];
% the central loop
for l = 1:M
    for j=1:N
        % Periodic boundary conditions
        if(j==1)
          jp = j + 1;
          jm = N;
        elseif(j==N)
          jp = 1;
          jm = j-1;
        else
          jp = j + 1;
          jm = j - 1;
        end
        n(j) = n(j) + dt.*(n11.*n(j) + n22.*n(jp) + n33.*n(jm) - r1.*n(j).*(n(j) + alpha1.*m(j)) + ...
            0.5.*n44.*((n(jp) + n(j)).*(c(jp) - c(j)) - (n(j) + n(jm)).*(c(j) - c(jm))) + ...
            0.5.*n55.*((n(jp) + n(j)).*(n(jp) - n(j)) - (n(j) + n(jm)).*(n(j) - n(jm))) + ...
            0.5.*n66.*((n(jp) + n(j)).*(m(jp) - m(j)) - (n(j) + n(jm)).*(m(j) - m(jm))));
        
        m(j) = m(j) + dt.*(m111.*m(j) + m221.*m(jp) + m331.*m(jm) - r2.*m(j).*(m(j) + alpha2.*n(j)) + ...
            0.5.*m441.*((m(jp) + m(j)).*(c(jp) - c(j)) - (m(j) + m(jm)).*(c(j) - c(jm))) + ...
            0.5.*n55.*((m(jp) + m(j)).*(n(jp) - n(j)) - (m(j) + m(jm)).*(n(j) - n(jm))) + ...
            0.5.*n66.*((m(jp) + m(j)).*(m(jp) - m(j)) - (m(j) + m(jm)).*(m(j) - m(jm))));

        c(j) = c(j) + dt.*(c11.*c(j) + c22.*c(jp) + c33.*c(jm) + n(j).*(h1 - beta1.*c(j)) + m(j).*(h2 - beta2.*c(j)) + ...
            0.5.*n55.*((c(jp) + c(j)).*(n(jp) - n(j)) - (c(j) + c(jm)).*(n(j) - n(jm))) + ...
            0.5.*n66.*((c(jp) + c(j)).*(m(jp) - m(j)) - (c(j) + c(jm)).*(m(j) - m(jm))));

        Nf1(l,j) = n(j); Mf1(l,j) = m(j); Cf1(l,j) = c(j);
        Er1(l,j) = (Nf1(l,j) - nn(l,j));
    end
end

figure
mesh(x,t,Nf1); grid off
xlabel 'r'; ylabel 't'; zlabel 'n(r,t)'

figure
mesh(x,t,Mf1); grid off
xlabel 'r'; ylabel 't'; zlabel 'm(r,t)'

figure
mesh(x,t,Cf1); grid off
xlabel 'r'; ylabel 't'; zlabel 'c(r,t)'

toc

% for l = 1:M
%     for j = 1:N
%         nn(l,j) = n0 + eps.*sech((x(j) - Ven(x(j)).*t(l) - x00n)./a).*cos(k*(x(j) - Vfr(x(j)).*t(l)));
%         mm(l,j) = m0 + eps.*sech((x(j) - Ven(x(j)).*t(l) - x00m)./a).*cos(k*(x(j) - Vfr(x(j)).*t(l)));
%         cc(l,j) = c0 + eps.*sech((x(j) - Ven(x(j)).*t(l) - x00n)./a).*cos(k*(x(j) - Vfr(x(j)).*t(l)));
%         Er0(l,j) = 0*nn(l,j);
%     end
% end

%%%%%%%%%%%%%%%%%% parameters of the Fig5a-f %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% r1 = 0.1; r2 = 0.9; alpha1 = 0.25; alpha2 = 0.9; mu = 0.035; beta = 30; 
% h1 = 1; h2 = 1; beta1 = 0.0035; beta2 = 0.0035; k = pi; eps = 0.01;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%